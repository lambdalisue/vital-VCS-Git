let s:V = vital#of('vital')
let s:P = s:V.import('System.Filepath')
let s:L = s:V.import('Data.List')
call s:V.unload() " make sure that the following modules are not cached version
let s:M = s:V.import('VCS.Git.Misc')

let s:ROOT = getcwd()

Describe VCS.Git.Misc
  Context .count_commits_ahead_of_remote([{options}])
    It should return number
      let path = s:ROOT
      let result = s:M.count_commits_ahead_of_remote()
      Assert IsNumber(result)
    End
  End

  Context .count_commits_behind_remote([{options}])
    It should return number
      let path = s:ROOT
      let result = s:M.count_commits_behind_remote()
      Assert IsNumber(result)
    End
  End

  Context .get_status([{options}])
    It should return a dictionary
      let ret = s:M.get_parsed_status()
      Assert IsDict(ret)
      Assert KeyNotExists(ret, 'current_branch')
      Assert KeyNotExists(ret, 'remote_branch')
    End

    It should add extra arguments specified
      let args = ['--verbose', '--branch']
      let ret = s:M.get_parsed_status({ 'args': args })
      Assert IsDict(ret)
      Assert KeyExists(ret, 'current_branch')
      Assert KeyExists(ret, 'remote_branch')
    End
  End

  Context .get_config([{options}])
    It should return a dictionary
      let result = s:M.get_parsed_config()
      Assert IsDict(result)
    End
  End
End
